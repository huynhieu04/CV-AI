<div class="page">
    <!-- HEADER -->
    <header class="page__header">
        <div>
            <h1 class="page__title">Danh S√°ch ·ª®ng Vi√™n</h1>
            <p class="page__subtitle">
                Danh s√°ch h·ªì s∆° ƒë√£ ƒë∆∞·ª£c AI ph√¢n t√≠ch. M·ªói ·ª©ng vi√™n c√≥ th·ªÉ c√≥ nhi·ªÅu k·∫øt qu·∫£
                so kh·ªõp v·ªõi c√°c v·ªã tr√≠ tuy·ªÉn d·ª•ng kh√°c nhau.
            </p>
            <p class="page__subtitle page__subtitle--meta">
                D·ªØ li·ªáu ƒë∆∞·ª£c sinh t·ª± ƒë·ªông khi upload CV ·ªü m√†n
                <strong>AI Classification</strong>.
            </p>
        </div>
    </header>

    <!-- CARD: Candidate list -->
    <section class="card">
        <div class="card__header">
            <div>
                <h2 class="card__title">Candidate list</h2>
                <p class="card__sub">
                    Danh s√°ch ·ª©ng vi√™n v√† v·ªã tr√≠ ph√π h·ª£p nh·∫•t do AI g·ª£i √Ω.
                </p>
            </div>
        </div>

        <!-- LOADING -->
        <ng-container *ngIf="isLoading; else dataOrEmpty">
            <div class="empty-state empty-state--inline">
                <div class="spinner"></div>
                <p class="empty-state__text">ƒêang t·∫£i d·ªØ li·ªáu t·ª´ MongoDB...</p>
            </div>
        </ng-container>

        <!-- DATA -->
        <ng-template #dataOrEmpty>
            <ng-container *ngIf="filteredRows.length; else emptyState">
                <table class="table">
                    <thead>
                        <tr>
                            <th style="width:70px">STT</th>
                            <th>Email</th>
                            <th>C√¥ng Vi·ªác T·ªët Nh·∫•t</th>
                            <th style="width:140px">M·ª©c ƒê·ªô Ph√π H·ª£p</th>
                            <th style="width:140px">Tr·∫°ng Th√°i</th>
                            <th style="width:170px">ƒê∆∞·ª£c T·∫°o V√†o</th>
                            <th class="table__th--action" style="width:90px">Xo√°</th>
                        </tr>
                    </thead>

                    <tbody>
                        <tr *ngFor="let c of filteredRows">
                            <!-- STT -->
                            <td>{{ c.stt }}</td>

                            <!-- Email ‚Üí AI result -->
                            <td class="table__mono">
                                <a class="table__link" [routerLink]="['/admin/ai-classification']"
                                    [queryParams]="{ candidateId: c.candidateId }">
                                    {{ c.email }}
                                </a>
                            </td>

                            <!-- Job ‚Üí AI result -->
                            <td>
                                <ng-container *ngIf="c.bestJobId; else noJob">
                                    <a class="table__link" [routerLink]="['/admin/ai-classification']"
                                        [queryParams]="{ candidateId: c.candidateId }">
                                        {{ c.bestJob }}
                                    </a>
                                </ng-container>

                                <ng-template #noJob>
                                    <span class="muted">Ch∆∞a c√≥ g·ª£i √Ω</span>
                                </ng-template>
                            </td>

                            <!-- Score -->
                            <td>{{ c.matchScore }}%</td>

                            <!-- Status -->
                            <td>
                                <span class="badge" [ngClass]="{
          'badge--success': c.status === 'Suitable',
          'badge--warning': c.status === 'Potential',
          'badge--danger': c.status === 'NotFit'
        }">
                                    {{ statusLabel(c.status) }}
                                </span>
                            </td>

                            <!-- Created -->
                            <td>{{ c.createdAt | date: 'dd/MM/yyyy, HH:mm' }}</td>

                            <!-- Delete -->
                            <td class="table__td--action">
                                <button type="button" class="btn-delete" title="Xo√° h·ªì s∆°"
                                    (click)="onDeleteCandidate(c.candidateId, $event)">
                                    Xo√°
                                </button>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </ng-container>

            <!-- EMPTY -->
            <ng-template #emptyState>
                <div class="empty-state">
                    <div class="empty-state__icon">üìÇ</div>
                    <h3 class="empty-state__title">Kh√¥ng c√≥ k·∫øt qu·∫£</h3>
                    <p class="empty-state__text">
                        Kh√¥ng t√¨m th·∫•y candidate ph√π h·ª£p v·ªõi t·ª´ kh√≥a t√¨m ki·∫øm tr√™n header.
                    </p>
                </div>
            </ng-template>
        </ng-template>

        <!-- ERROR -->
        <p *ngIf="errorMessage" class="error-text">
            {{ errorMessage }}
        </p>
    </section>
</div>